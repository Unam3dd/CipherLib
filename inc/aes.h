#ifndef AES_H
#define AES_H

//////////////////////////////////
//
//			INCLUDES
//
//////////////////////////////////

#include "cpuid.h"
#include <stddef.h>
#include <wmmintrin.h>

//////////////////////////////////
//
//			DEFINES
//
//////////////////////////////////

#define AES_CPUID_VALUE 0x2000000
#define AES_KEY_MAX_ROUND 0x10

//////////////////////////////////
//
//			SUPPORT AES-NI
//
//////////////////////////////////

int	check_cpu_support_aes(void);

//////////////////////////////////
//
//			TYPEDEFS
//
//////////////////////////////////

typedef struct aes_key_t	aes_key_t;
typedef enum   aes_flag_t	aes_flag_t;

//////////////////////////////////
//
//			ENUM
//
//////////////////////////////////

enum aes_flag_t
{
	AES_ECB_128,
	AES_CBC_128
};

//////////////////////////////////
//
//			STRUCTS
//
//////////////////////////////////

struct aes_key_t
{
	__m128i	key[AES_KEY_MAX_ROUND];
};

#endif
